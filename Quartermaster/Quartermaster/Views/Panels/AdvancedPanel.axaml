<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="900"
             x:Class="Quartermaster.Views.Panels.AdvancedPanel">

    <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="20" Margin="20,20,50,20">
                <!-- Header -->
                <TextBlock Text="Advanced Properties"
                           FontSize="{DynamicResource FontSizeXLarge}"
                           FontWeight="Bold"/>

                <!-- Blueprint/Identity Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15"
                        x:Name="BlueprintSection">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Identity" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <StackPanel Spacing="8">
                            <!-- Blueprint ResRef (UTC only - hidden for BIC) -->
                            <Grid x:Name="ResRefRow" ColumnDefinitions="Auto,*,Auto,Auto" ColumnSpacing="10">
                                <TextBlock Grid.Column="0" Text="Blueprint ResRef:"
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                           VerticalAlignment="Center" Width="100"/>
                                <TextBox Grid.Column="1" x:Name="TemplateResRefTextBox"
                                         FontFamily="Consolas, Courier New, monospace"
                                         IsReadOnly="True"
                                         AutomationProperties.AutomationId="TemplateResRefTextBox"
                                         ToolTip.Tip="Read-only. Click Rename to change."/>
                                <Button Grid.Column="2" x:Name="CopyResRefButton"
                                        Content="Copy" Padding="8,2" FontSize="{DynamicResource FontSizeSmall}"
                                        AutomationProperties.AutomationId="CopyResRefButton"
                                        ToolTip.Tip="Copy ResRef to clipboard"/>
                                <Button Grid.Column="3" x:Name="RenameResRefButton"
                                        Content="Rename" Padding="8,2" FontSize="{DynamicResource FontSizeSmall}"
                                        AutomationProperties.AutomationId="RenameResRefButton"
                                        ToolTip.Tip="Rename file and update ResRef"/>
                            </Grid>

                            <!-- Tag (editable - both UTC and BIC) -->
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                                <TextBlock Grid.Column="0" Text="Tag:"
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                           VerticalAlignment="Center" Width="100"/>
                                <TextBox Grid.Column="1" x:Name="TagTextBox"
                                         FontFamily="Consolas, Courier New, monospace"
                                         AutomationProperties.AutomationId="TagTextBox"/>
                                <Button Grid.Column="2" x:Name="CopyTagButton"
                                        Content="Copy" Padding="8,2" FontSize="{DynamicResource FontSizeSmall}"
                                        AutomationProperties.AutomationId="CopyTagButton"
                                        ToolTip.Tip="Copy Tag to clipboard"/>
                            </Grid>

                            <!-- Comment (UTC only - hidden for BIC) -->
                            <Grid x:Name="CommentRow" ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                <TextBlock Grid.Column="0" Text="Comment:"
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                           VerticalAlignment="Top" Margin="0,5,0,0" Width="100"/>
                                <TextBox Grid.Column="1"
                                         x:Name="CommentTextBox"
                                         AcceptsReturn="True"
                                         TextWrapping="Wrap"
                                         MinHeight="60"
                                         MaxHeight="120"
                                         AutomationProperties.AutomationId="CommentTextBox"
                                         Watermark="Developer notes..."/>
                            </Grid>

                            <!-- Palette Category (UTC only - hidden for BIC) -->
                            <Grid x:Name="PaletteCategoryRow" ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                <TextBlock Grid.Column="0" Text="Palette Category:"
                                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                           VerticalAlignment="Center" Width="100"/>
                                <ComboBox Grid.Column="1" x:Name="PaletteCategoryComboBox"
                                          HorizontalAlignment="Left" MinWidth="250"
                                          AutomationProperties.AutomationId="PaletteCategoryComboBox"
                                          ToolTip.Tip="Category where creature appears in Aurora Toolset palette"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Flags Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Flags" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <WrapPanel Orientation="Horizontal">
                            <CheckBox x:Name="PlotCheckBox" Content="Plot" Margin="0,0,15,8"/>
                            <CheckBox x:Name="ImmortalCheckBox" Content="Immortal" Margin="0,0,15,8"/>
                            <CheckBox x:Name="NoPermDeathCheckBox" Content="No Perm Death" Margin="0,0,15,8"/>
                            <CheckBox x:Name="IsPCCheckBox" Content="Is PC" Margin="0,0,15,8"/>
                            <CheckBox x:Name="DisarmableCheckBox" Content="Disarmable" Margin="0,0,15,8"/>
                            <CheckBox x:Name="LootableCheckBox" Content="Lootable" Margin="0,0,15,8"/>
                            <CheckBox x:Name="InterruptableCheckBox" Content="Interruptable" Margin="0,0,15,8"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <!-- Behavior Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Behavior" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <Grid ColumnDefinitions="120,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="8" ColumnSpacing="15">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Faction:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="*,Auto">
                                <TextBox Grid.Column="0" x:Name="FactionTextBox"
                                         MinWidth="140" MaxWidth="200"
                                         IsReadOnly="True"
                                         AutomationProperties.AutomationId="FactionTextBox"/>
                                <Button Grid.Column="1" x:Name="FactionBrowseButton"
                                        Content="..." Width="30" Margin="5,0,0,0"
                                        ToolTip.Tip="Browse factions from repute.fac"
                                        AutomationProperties.AutomationId="FactionBrowseButton"/>
                            </Grid>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Perception Range:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="1" Grid.Column="1" x:Name="PerceptionComboBox"
                                      HorizontalAlignment="Left" MinWidth="180"
                                      AutomationProperties.AutomationId="PerceptionComboBox"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Movement Speed:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="WalkRateComboBox"
                                      HorizontalAlignment="Left" MinWidth="180"
                                      AutomationProperties.AutomationId="WalkRateComboBox"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Decay Time:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="3" Grid.Column="1" x:Name="DecayTimeComboBox"
                                      HorizontalAlignment="Left" MinWidth="180"
                                      AutomationProperties.AutomationId="DecayTimeComboBox"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Body Bag:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="4" Grid.Column="1" x:Name="BodyBagComboBox"
                                      HorizontalAlignment="Left" MinWidth="180"
                                      AutomationProperties.AutomationId="BodyBagComboBox"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Local Variables Section (UTC only - hidden for BIC) -->
                <Border x:Name="VariablesSection"
                        BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Local Variables" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <DockPanel>
                            <!-- Action Buttons -->
                            <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                                <Button x:Name="AddVariableButton" Content="Add"
                                        AutomationProperties.AutomationId="AddVariableButton"/>
                                <Button x:Name="RemoveVariableButton" Content="Remove"
                                        AutomationProperties.AutomationId="RemoveVariableButton"/>
                            </StackPanel>

                            <!-- Variables DataGrid -->
                            <DataGrid x:Name="VariablesGrid"
                                      AutoGenerateColumns="False"
                                      CanUserReorderColumns="True"
                                      CanUserResizeColumns="True"
                                      CanUserSortColumns="True"
                                      IsReadOnly="False"
                                      SelectionMode="Extended"
                                      GridLinesVisibility="Horizontal"
                                      MaxHeight="200"
                                      AutomationProperties.AutomationId="VariablesGrid">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Name" Width="140" Binding="{Binding Name}"/>
                                    <DataGridTemplateColumn Header="Type" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <ComboBox SelectedIndex="{Binding TypeIndex}"
                                                          HorizontalAlignment="Stretch"
                                                          Margin="2">
                                                    <ComboBoxItem Content="Int"/>
                                                    <ComboBoxItem Content="Float"/>
                                                    <ComboBoxItem Content="String"/>
                                                </ComboBox>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="Value" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <!-- Int value editor -->
                                                    <NumericUpDown Value="{Binding IntValue}"
                                                                   IsVisible="{Binding IsIntType}"
                                                                   Minimum="-2147483648"
                                                                   Maximum="2147483647"
                                                                   FormatString="0"
                                                                   Margin="2"/>
                                                    <!-- Float value editor -->
                                                    <NumericUpDown Value="{Binding FloatValue}"
                                                                   IsVisible="{Binding IsFloatType}"
                                                                   FormatString="F3"
                                                                   Increment="0.1"
                                                                   Margin="2"/>
                                                    <!-- String value editor -->
                                                    <TextBox Text="{Binding StringValue}"
                                                             IsVisible="{Binding IsStringType}"
                                                             Margin="2"/>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </DockPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Border>
</UserControl>
