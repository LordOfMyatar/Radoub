<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="600"
             x:Class="Quartermaster.Views.Panels.CharacterPanel">

    <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="20" Margin="20,20,50,20">
                <!-- Header -->
                <TextBlock Text="Character"
                           FontSize="{DynamicResource FontSizeXLarge}"
                           FontWeight="Bold"/>

                <!-- Name Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Name" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto" RowSpacing="8" ColumnSpacing="15">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="First Name:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="FirstNameTextBox"
                                     AutomationProperties.AutomationId="FirstNameTextBox"
                                     Watermark="Character's first name"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Last Name:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="LastNameTextBox"
                                     AutomationProperties.AutomationId="LastNameTextBox"
                                     Watermark="Character's last name (optional)"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Identity Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Identity" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" RowSpacing="8" ColumnSpacing="15">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Race:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" x:Name="RaceComboBox"
                                      HorizontalAlignment="Stretch"
                                      AutomationProperties.AutomationId="RaceComboBox"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Subrace:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="SubraceTextBox"
                                     AutomationProperties.AutomationId="SubraceTextBox"
                                     Watermark="e.g., Gold Elf, Shield Dwarf"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Deity:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="2" Grid.Column="1" x:Name="DeityTextBox"
                                     AutomationProperties.AutomationId="DeityTextBox"
                                     Watermark="e.g., Mystra, Torm"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Portrait:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <Grid Grid.Row="3" Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="5">
                                <ComboBox Grid.Column="0" x:Name="PortraitComboBox"
                                          HorizontalAlignment="Stretch"
                                          AutomationProperties.AutomationId="PortraitComboBox"/>
                                <Button Grid.Column="1" x:Name="BrowsePortraitButton"
                                        Content="..."
                                        Padding="8,4"
                                        ToolTip.Tip="Browse portraits"
                                        AutomationProperties.AutomationId="BrowsePortraitButton"/>
                            </Grid>

                            <!-- Portrait ID (row from portraits.2da) - UTC files use this -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Portrait ID:"
                                       x:Name="PortraitIdLabel"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="4" Grid.Column="1" x:Name="PortraitIdTextBox"
                                     Width="80" HorizontalAlignment="Left"
                                     AutomationProperties.AutomationId="PortraitIdTextBox"
                                     ToolTip.Tip="Row number in portraits.2da (UTC files)"/>

                            <!-- Portrait ResRef (string) - BIC files use this -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Portrait ResRef:"
                                       x:Name="PortraitResRefLabel"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="5" Grid.Column="1" x:Name="PortraitResRefTextBox"
                                     FontFamily="Consolas, Courier New, monospace"
                                     AutomationProperties.AutomationId="PortraitResRefTextBox"
                                     ToolTip.Tip="Portrait resource reference (BIC files). Example: po_hu_m_01_"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Voice & Dialog Section -->
                <Border BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Voice &amp; Dialog" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto" RowSpacing="8" ColumnSpacing="15">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Sound Set:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="5">
                                <ComboBox Grid.Column="0" x:Name="SoundSetComboBox"
                                          HorizontalAlignment="Stretch"
                                          AutomationProperties.AutomationId="SoundSetComboBox"/>
                                <Button Grid.Column="1" x:Name="BrowseSoundSetButton"
                                        Content="..."
                                        Padding="8,4"
                                        ToolTip.Tip="Browse soundsets"
                                        AutomationProperties.AutomationId="BrowseSoundSetButton"/>
                            </Grid>

                            <!-- Soundset preview (#916) -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Preview:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="5">
                                <ComboBox x:Name="SoundsetTypeComboBox" Width="120" Height="28"
                                          ToolTip.Tip="Select sound type to preview"
                                          AutomationProperties.AutomationId="SoundsetTypeComboBox">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}"
                                                       Opacity="{Binding Opacity}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <Button x:Name="SoundsetPlayButton" Content="Play" Padding="8,4"
                                        ToolTip.Tip="Play selected soundset sound"
                                        AutomationProperties.AutomationId="SoundsetPlayButton"/>
                            </StackPanel>

                            <!-- Conversation row - hidden for BIC files -->
                            <TextBlock Grid.Row="2" Grid.Column="0" x:Name="ConversationLabel" Text="Conversation:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <Grid Grid.Row="2" Grid.Column="1" x:Name="ConversationRow" ColumnDefinitions="*,Auto" ColumnSpacing="5">
                                <TextBox Grid.Column="0" x:Name="ConversationTextBox"
                                         FontFamily="Consolas, Courier New, monospace"
                                         MaxLength="16"
                                         Watermark="(none)"
                                         AutomationProperties.AutomationId="ConversationTextBox"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="5">
                                    <Button x:Name="BrowseConversationButton"
                                            Content="..."
                                            Padding="8,4"
                                            ToolTip.Tip="Browse dialogs"
                                            AutomationProperties.AutomationId="BrowseConversationButton"/>
                                    <Button x:Name="ClearConversationButton"
                                            Content="âœ•"
                                            Padding="8,4"
                                            ToolTip.Tip="Clear conversation"
                                            AutomationProperties.AutomationId="ClearConversationButton"/>
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Player Character Section (BIC only) -->
                <Border x:Name="PlayerCharacterSection"
                        BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15"
                        IsVisible="False">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Player Character" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>

                        <Grid ColumnDefinitions="Auto,*,20,Auto,*" RowDefinitions="Auto,Auto" RowSpacing="8" ColumnSpacing="15">
                            <!-- Experience -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Experience:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="ExperienceTextBox"
                                     Watermark="0"
                                     AutomationProperties.AutomationId="ExperienceTextBox"/>

                            <!-- Gold -->
                            <TextBlock Grid.Row="0" Grid.Column="3" Text="Gold:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="4" x:Name="GoldTextBox"
                                     Watermark="0"
                                     AutomationProperties.AutomationId="GoldTextBox"/>

                            <!-- Age -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Age:"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="AgeTextBox"
                                     Watermark="0"
                                     AutomationProperties.AutomationId="AgeTextBox"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Biography Section (BIC only) -->
                <Border x:Name="BiographySection"
                        BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="15"
                        IsVisible="False">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Biography" FontWeight="SemiBold" FontSize="{DynamicResource FontSizeNormal}"/>
                        <TextBox x:Name="BiographyTextBox"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 MinHeight="100"
                                 MaxHeight="200"
                                 Watermark="Character biography (shown when examined)"
                                 AutomationProperties.AutomationId="BiographyTextBox"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Border>
</UserControl>
