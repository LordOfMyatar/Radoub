<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="using:Radoub.UI.Controls"
        xmlns:panels="using:Quartermaster.Views.Panels"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="Quartermaster.Views.MainWindow"
        x:Name="MainWindowInstance"
        Title="Quartermaster"
        Icon="avares://Quartermaster/Assets/Quartermaster.ico"
        Width="1200" Height="800"
        MinWidth="800" MinHeight="600"
        KeyDown="OnWindowKeyDown">

    <Window.Styles>
        <!-- Navigation Button Style -->
        <Style Selector="Button.NavButton">
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style Selector="Button.NavButton:pointerover">
            <Setter Property="Background" Value="{DynamicResource SystemControlHighlightListLowBrush}"/>
        </Style>
        <Style Selector="Button.NavButton.Selected">
            <Setter Property="Background" Value="{DynamicResource SystemAccentColor}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <!-- Emoji icons should not inherit foreground color changes -->
        <Style Selector="Button.NavButton TextBlock.NavIcon">
            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        </Style>
    </Window.Styles>

    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top" AutomationProperties.AutomationId="MainMenu">
            <MenuItem Header="_File">
                <MenuItem Header="_Open..." Click="OnOpenClick" InputGesture="Ctrl+O"/>
                <MenuItem Header="Open _Recent" x:Name="RecentFilesMenu"/>
                <Separator/>
                <MenuItem Header="_Save" Click="OnSaveClick" InputGesture="Ctrl+S" IsEnabled="{Binding HasFile, ElementName=MainWindowInstance}"/>
                <MenuItem Header="Save _As..." Click="OnSaveAsClick" InputGesture="Ctrl+Shift+S" IsEnabled="{Binding HasFile, ElementName=MainWindowInstance}"/>
                <Separator/>
                <MenuItem Header="_Export Character Sheet">
                    <MenuItem Header="Export as _Text..." Click="OnExportTextClick" InputGesture="Ctrl+Shift+E" IsEnabled="{Binding HasFile, ElementName=MainWindowInstance}"/>
                    <MenuItem Header="Export as _Markdown..." Click="OnExportMarkdownClick" IsEnabled="{Binding HasFile, ElementName=MainWindowInstance}"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="_Close" Click="OnCloseFileClick" IsEnabled="{Binding HasFile, ElementName=MainWindowInstance}"/>
                <MenuItem Header="E_xit" Click="OnExitClick" InputGesture="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Undo" InputGesture="Ctrl+Z" IsEnabled="False" ToolTip.Tip="Not yet implemented"/>
                <MenuItem Header="_Redo" InputGesture="Ctrl+Y" IsEnabled="False" ToolTip.Tip="Not yet implemented"/>
                <Separator/>
                <MenuItem Header="Cu_t" InputGesture="Ctrl+X" IsEnabled="False" ToolTip.Tip="Not yet implemented"/>
                <MenuItem Header="_Copy" InputGesture="Ctrl+C" IsEnabled="False" ToolTip.Tip="Not yet implemented"/>
                <MenuItem Header="_Paste" InputGesture="Ctrl+V" IsEnabled="False" ToolTip.Tip="Not yet implemented"/>
                <MenuItem Header="_Delete" Click="OnDeleteClick" InputGesture="Delete" IsEnabled="{Binding HasSelection, ElementName=MainWindowInstance}"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="_Settings..." Click="OnSettingsClick"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About Quartermaster" Click="OnAboutClick"/>
            </MenuItem>
        </Menu>

        <!-- Status Bar -->
        <Border DockPanel.Dock="Bottom" BorderBrush="{DynamicResource SystemBaseMediumLowColor}" BorderThickness="0,1,0,0" Padding="5,2"
                AutomationProperties.AutomationId="StatusBar">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Ready" AutomationProperties.AutomationId="StatusText"/>
                <TextBlock x:Name="InventoryCountText" Grid.Column="1" Text="" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" Margin="20,0,0,0"/>
                <TextBlock x:Name="FilePathText" Grid.Column="2" Text="" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" Margin="20,0,0,0"/>
            </Grid>
        </Border>

        <!-- Main Content - Sidebar + Content Layout -->
        <Grid x:Name="MainGrid">
            <Grid.ColumnDefinitions>
                <!-- Sidebar -->
                <ColumnDefinition Width="200" MinWidth="140" MaxWidth="300"/>
                <ColumnDefinition Width="5"/>
                <!-- Content Area - reduced minimum for 1024x768 support -->
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- Sidebar -->
            <Border Grid.Column="0" BorderBrush="{DynamicResource SystemBaseMediumLowColor}" BorderThickness="0,0,1,0"
                    AutomationProperties.AutomationId="Sidebar">
                <DockPanel>
                    <!-- Character Header (Portrait + Name) -->
                    <Border DockPanel.Dock="Top" Padding="10" BorderBrush="{DynamicResource SystemBaseMediumLowColor}" BorderThickness="0,0,0,1">
                        <StackPanel Spacing="8">
                            <!-- Portrait Display -->
                            <Border x:Name="PortraitBorder" Width="100" Height="100"
                                    Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                                    BorderBrush="{DynamicResource SystemBaseMediumLowColor}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    HorizontalAlignment="Center"
                                    AutomationProperties.AutomationId="CharacterPortrait">
                                <Grid>
                                    <!-- Placeholder text (shown when no portrait) -->
                                    <TextBlock x:Name="PortraitPlaceholderText"
                                               Text="No Portrait"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                               FontSize="{DynamicResource FontSizeSmall}"/>
                                    <!-- Portrait image (shown when portrait available) -->
                                    <Image x:Name="PortraitImage"
                                           Stretch="UniformToFill"
                                           IsVisible="False"/>
                                </Grid>
                            </Border>

                            <!-- Character Name -->
                            <TextBlock x:Name="CharacterNameText"
                                       Text="No Character Loaded"
                                       FontWeight="Bold"
                                       FontSize="{DynamicResource FontSizeNormal}"
                                       HorizontalAlignment="Center"
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       AutomationProperties.AutomationId="CharacterName"/>

                            <!-- Race/Class Summary -->
                            <TextBlock x:Name="CharacterSummaryText"
                                       Text=""
                                       FontSize="{DynamicResource FontSizeSmall}"
                                       HorizontalAlignment="Center"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       AutomationProperties.AutomationId="CharacterSummary"/>
                        </StackPanel>
                    </Border>

                    <!-- Navigation Buttons -->
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Spacing="2" Margin="8">
                            <Button x:Name="NavCharacter" Classes="NavButton Selected"
                                    Click="OnNavButtonClick" Tag="Character"
                                    AutomationProperties.AutomationId="NavButton_Character">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="☺" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Character" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavAppearance" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Appearance"
                                    AutomationProperties.AutomationId="NavButton_Appearance">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="○" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Appearance" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavClasses" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Classes"
                                    AutomationProperties.AutomationId="NavButton_Classes">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="⚔" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Classes" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavStats" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Stats"
                                    AutomationProperties.AutomationId="NavButton_Stats">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="≡" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Stats" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavFeats" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Feats"
                                    AutomationProperties.AutomationId="NavButton_Feats">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="★" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Feats" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavSkills" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Skills"
                                    AutomationProperties.AutomationId="NavButton_Skills">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="◎" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Skills" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavSpells" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Spells"
                                    AutomationProperties.AutomationId="NavButton_Spells">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="✦" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Spells" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavInventory" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Inventory"
                                    AutomationProperties.AutomationId="NavButton_Inventory">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="■" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Inventory" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavAdvanced" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Advanced"
                                    AutomationProperties.AutomationId="NavButton_Advanced">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="⚙" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Advanced" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavScripts" Classes="NavButton"
                                    Click="OnNavButtonClick" Tag="Scripts"
                                    AutomationProperties.AutomationId="NavButton_Scripts">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="☰" FontSize="{DynamicResource FontSizeNormal}" Classes="NavIcon"/>
                                    <TextBlock Text="Scripts" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>
            </Border>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"
                          Background="{DynamicResource SystemBaseMediumLowColor}"
                          AutomationProperties.AutomationId="SidebarSplitter"/>

            <!-- Content Area -->
            <Border Grid.Column="2" AutomationProperties.AutomationId="ContentArea">
                <Grid x:Name="ContentPanel">
                    <!-- Character Panel -->
                    <panels:CharacterPanel x:Name="CharacterPanelContent" IsVisible="True"
                                           AutomationProperties.AutomationId="CharacterPanel"/>

                    <!-- Stats Panel -->
                    <panels:StatsPanel x:Name="StatsPanelContent" IsVisible="False"
                                       AutomationProperties.AutomationId="StatsPanel"/>

                    <!-- Classes Panel -->
                    <panels:ClassesPanel x:Name="ClassesPanelContent" IsVisible="False"
                                         AutomationProperties.AutomationId="ClassesPanel"/>

                    <!-- Skills Panel -->
                    <panels:SkillsPanel x:Name="SkillsPanelContent" IsVisible="False"
                                        AutomationProperties.AutomationId="SkillsPanel"/>

                    <!-- Feats Panel -->
                    <panels:FeatsPanel x:Name="FeatsPanelContent" IsVisible="False"
                                       AutomationProperties.AutomationId="FeatsPanel"/>

                    <!-- Spells Panel -->
                    <panels:SpellsPanel x:Name="SpellsPanelContent" IsVisible="False"
                                        AutomationProperties.AutomationId="SpellsPanel"/>

                    <!-- Inventory Panel -->
                    <panels:InventoryPanel x:Name="InventoryPanelContent" IsVisible="False"
                                           AutomationProperties.AutomationId="InventoryPanel"/>

                    <!-- Appearance Panel -->
                    <panels:AppearancePanel x:Name="AppearancePanelContent" IsVisible="False"
                                            AutomationProperties.AutomationId="AppearancePanel"/>

                    <!-- Advanced Panel -->
                    <panels:AdvancedPanel x:Name="AdvancedPanelContent" IsVisible="False"
                                          AutomationProperties.AutomationId="AdvancedPanel"/>

                    <!-- Scripts Panel -->
                    <panels:ScriptsPanel x:Name="ScriptsPanelContent" IsVisible="False"
                                         AutomationProperties.AutomationId="ScriptsPanel"/>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>
